# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.
# https://aka.ms/yaml

name: $(SourceBranchName)-PR-$(Date:yyyy-MM-dd)$(Rev:.r)

trigger: none

pool:
  vmImage: windows-latest

stages:
- stage: SecurityPreChecks
  displayName: 'Security Pre Checks'
  jobs:
  - job: MsGraphPSSDKSecurityPreChecks
    displayName: Microsoft Graph PowerShell SDK Security Pre Checks
    steps:
      - template: ./common-templates/security-prechecks-template.yml

- stage: Build
  displayName: 'Build Compatibility Adapter'
  jobs:
  - job: Build
    displayName: Microsoft Graph PowerShell SDK Security Post Checks
    steps:
      - template: ./build.yml

- stage: SecurityPostChecks
  displayName: 'Security Post Checks'
  jobs:
  - job: SecurityPostChecks
    displayName: Microsoft Graph PowerShell SDK Security Post Checks
    steps:
      - template: ./common-templates/security-postchecks-template.yml